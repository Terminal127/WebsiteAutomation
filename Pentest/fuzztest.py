import subprocess

# ANSI escape codes for text colors
GREEN = "\033[92m"
CYAN = "\033[96m"
RESET = "\033[0m"
# Define the command to run the website fuzzing script
website_fuzzing_script = "python3 nmap.py"  # Replace with the actual path

# Run the website fuzzing script using subprocess
try:
    subprocess.run(website_fuzzing_script, shell=True, check=True)
except subprocess.CalledProcessError as e:
    print("Error running the nmap scan:", e)
def print_banner():
    banner = f"""
{GREEN}  _____ _   _ __________    ___ _   _  ____
 |  ___| | | |__  /__  /   |_ _| \ | |/ ___| 
 | |_  | | | | / /  / /_____| ||  \| | |  _  
 |  _| | |_| |/ /_ / /|_____| || |\  | |_| | 
 |_|    \___//____/____|   |___|_| \_|\____| 
{CYAN}    
    Website Fuzzing Script by Anubhav
{RESET}
    """
    print(banner)

def main_menu():
    print_banner()
    print(f"{CYAN}1. Directory Fuzzing")
    print("2. Extension Fuzzing")
    print("3. Recursive Fuzzing")
    print("4. Subdomain Fuzzing")
    print("5. Exit")
    choice = input(f"{CYAN}Enter your choice (1/2/3/4/5): {RESET}")

    if choice == '1':
        target_ip = input("Enter the target IP address: ")
        custom_website_name = input("Enter the custom website name (e.g., www.example.com): ")
        directory_fuzzing(target_ip, custom_website_name)
    elif choice == '2':
        target_ip = input("Enter the target IP address: ")
        port = input("Enter the target port (e.g., 80): ")
        url_path = input("Enter the URL path (e.g., /blog/index): ")
        extension_fuzzing(target_ip, port, url_path)
    elif choice == '3':
        target_ip = input("Enter the target IP address: ")
        port = input("Enter the target port (e.g., 80): ")
        url_path = input("Enter the URL path (e.g., /blog/index): ")
        recursion_depth = input("Enter the recursion depth (e.g., 1): ")
        extensions = input("Enter extensions to search (e.g., .php): ")
        recursive_fuzzing(target_ip, port, url_path, recursion_depth, extensions)
    elif choice == '4':
        target_ip = input("Enter the target IP address: ")
        custom_website_name = input("Enter the target website name (e.g., academy.htb): ")
        subdomain_fuzzing(target_ip, custom_website_name)
    elif choice == '5':
        print("Exiting the script.")
    else:
        print("Invalid choice. Please enter 1, 2, 3, 4, or 5.")
        main_menu()

def directory_fuzzing(target_ip, custom_website_name):
    ffuf_command = f"ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://{target_ip}/FUZZ"

    try:
        subprocess.run(ffuf_command, shell=True, check=True)
        
        with open("/etc/hosts", "a") as hosts_file:
            hosts_file.write(f"\n# Added by Website Fuzzing Script\n")
            hosts_file.write(f"{target_ip} {custom_website_name}\n")

        print(f"Added custom entry: {target_ip} {custom_website_name}")

    except subprocess.CalledProcessError as e:
        print(f"{GREEN}Error running ffuf:{RESET}", e)

    except PermissionError:
        print(f"{GREEN}Permission denied. Run the script with administrative privileges to modify /etc/hosts.{RESET}")

def extension_fuzzing(target_ip, port, url_path):
    extension_ffuf_command = f"ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://{target_ip}:{port}{url_path}/indexFUZZ"

    try:
        subprocess.run(extension_ffuf_command, shell=True, check=True)
    
    except subprocess.CalledProcessError as e:
        print(f"{GREEN}Error running ffuf:{RESET}", e)

def recursive_fuzzing(target_ip, port, url_path, recursion_depth, extensions):
    ffuf_command = f"ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://{target_ip}:{port}{url_path}/FUZZ -recursion -recursion-depth {recursion_depth} -e {extensions} -v"

    try:
        subprocess.run(ffuf_command, shell=True, check=True)
    
    except subprocess.CalledProcessError as e:
        print(f"{GREEN}Error running ffuf:{RESET}", e)

def subdomain_fuzzing(target_ip, custom_website_name):
    ffuf_command = f"ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt:FUZZ -u http://FUZZ.{custom_website_name}/"

    try:
        subprocess.run(ffuf_command, shell=True, check=True)
        
        with open("/etc/hosts", "a") as hosts_file:
            hosts_file.write(f"\n# Added by Subdomain Fuzzing Script\n")
            hosts_file.write(f"{target_ip} {custom_website_name}\n")

        print(f"Added custom entry: {target_ip} {custom_website_name}")

    except subprocess.CalledProcessError as e:
        print(f"{GREEN}Error running ffuf:{RESET}", e)

if __name__ == "__main__":
    main_menu()

