import subprocess

def print_banner():
    banner = """
  _____ _   _ __________    ___ _   _  ____  
 |  ___| | | |__  /__  /   |_ _| \ | |/ ___| 
 | |_  | | | | / /  / /_____| ||  \| | |  _  
 |  _| | |_| |/ /_ / /|_____| || |\  | |_| | 
 |_|    \___//____/____|   |___|_| \_|\____| 
    
    Website Fuzzing Script by Anubhav
    """
    print(banner)

def main_menu():
    print_banner()
    print("1. Directory Fuzzing")
    print("2. Extension Fuzzing")
    print("3. Exit")
    choice = input("Enter your choice (1/2/3): ")

    if choice == '1':
        target_ip = input("Enter the target IP address: ")
        custom_website_name = input("Enter the custom website name (e.g., www.example.com): ")
        directory_fuzzing(target_ip, custom_website_name)
    elif choice == '2':
        target_ip = input("Enter the target IP address: ")
        port = input("Enter the target port (e.g., 80): ")
        url_path = input("Enter the URL path (e.g., /blog/index): ")
        extension_fuzzing(target_ip, port, url_path)
    elif choice == '3':
        print("Exiting the script.")
    else:
        print("Invalid choice. Please enter 1, 2, or 3.")
        main_menu()

def directory_fuzzing(target_ip, custom_website_name):
    ffuf_command = f"ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt:FUZZ -u http://{target_ip}/FUZZ -fs 301"

    try:
        subprocess.run(ffuf_command, shell=True, check=True)
        
        with open("/etc/hosts", "a") as hosts_file:
            hosts_file.write(f"\n# Added by Website Fuzzing Script\n")
            hosts_file.write(f"{target_ip} {custom_website_name}\n")

        print(f"Added custom entry: {target_ip} {custom_website_name}")

    except subprocess.CalledProcessError as e:
        print("Error running ffuf:", e)

    except PermissionError:
        print("Permission denied. Run the script with administrative privileges to modify /etc/hosts.")

def extension_fuzzing(target_ip, port, url_path):
    extension_ffuf_command = f"ffuf -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt:FUZZ -u http://{target_ip}:{port}{url_path}/indexFUZZ"

    try:
        subprocess.run(extension_ffuf_command, shell=True, check=True)
    
    except subprocess.CalledProcessError as e:
        print("Error running ffuf:", e)

if __name__ == "__main__":
    main_menu()

