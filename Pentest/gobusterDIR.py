import subprocess
import os

# Ask the user if they want to enter a URL or an IP address
while True:
    target_choice = input("Enter 'U' for URL or 'I' for IP address: ").strip().lower()
    if target_choice == 'u':
        target = input("Enter the target URL: ").strip()
        break
    elif target_choice == 'i':
        target_ip = input("Enter the target IP address: ").strip()

        # Ask if the user wants to add an entry in the hosts file
        add_to_hosts = input(f"Do you want to add an entry for {target_ip} in your hosts file (Y/N)? ").strip().lower()
        if add_to_hosts == 'y':
            target = input("Enter the target URL of the site: ").strip()
            # Append an entry to the hosts file
            with open('/etc/hosts', 'a') as hosts_file:
                hosts_file.write(f"{target_ip} {target}\n")
            print(f"Entry for {target_ip} ({target}) added to hosts file.")
        else:
            target = target_ip
        break
    else:
        print("Invalid choice. Please enter 'U' for URL or 'I' for IP address.")

# Ask the user if they want to use the IP address as is or enter a hostname
while True:
    use_ip_as_is = input("Do you want to use the IP address as is (Y/N)? ").strip().lower()
    if use_ip_as_is == 'y':
        break
    elif use_ip_as_is == 'n':
        target = input("Enter the target hostname (e.g., www.example.com): ").strip()
        break
    else:
        print("Invalid choice. Please enter 'Y' for yes or 'N' for no.")

# Define the path to the wordlists directory
wordlist_dir = "/usr/share/seclists/Discovery/Web-Content"

# List available wordlists in the directory
wordlists = os.listdir(wordlist_dir)

# Display available wordlists to the user
print("\nAvailable wordlists:")
for i, wordlist in enumerate(wordlists, start=1):
    print(f"{i}. {wordlist}")

# Ask the user to select a wordlist
while True:
    try:
        choice = int(input("Enter the number of the wordlist to use: "))
        if 1 <= choice <= len(wordlists):
            selected_wordlist = os.path.join(wordlist_dir, wordlists[choice - 1])
            break
        else:
            print("Invalid choice. Please select a valid number.")
    except ValueError:
        print("Invalid input. Please enter a number.")

# Define the command as a list of strings
if use_ip_as_is == 'y':
    command = ["gobuster", "dir", "-u", target, "-w", selected_wordlist]
else:
    command = ["gobuster", "dir", "-u", target, "-w", selected_wordlist]

try:
    # Run the gobuster command
    subprocess.run(command, check=True)
except subprocess.CalledProcessError as e:
    print(f"Error running gobuster: {e}")
except FileNotFoundError:
    print("gobuster command not found. Make sure it's installed and in your PATH.")

